"use strict";(self.webpackChunkBenStockTracker=self.webpackChunkBenStockTracker||[]).push([[333],{333:(Mt,y,c)=>{c.r(y),c.d(y,{PortfolioModule:()=>Ft});var p=c(9808),d=c(3075),O=c(8985),R=c(4620),C=c(1083),t=c(5e3),h=c(3251),r=c(4999),H=c(9062),f=c(4847),g=c(1777),k=c(7261),S=c(520),N=c(9646),P=c(5625),U=c(262);let _=(()=>{class o{constructor(e,n){this.http=e,this.snackBar=n,this.backendServerUrl="http://127.0.0.1:5000",this.httpOptions={headers:(new S.WM).set("content-type","application/json").set("Access-Control-Allow-Origin","*")}}showSnackBar(e){this.snackBar.open(e,"Dismiss",{duration:3e3,horizontalPosition:"right",verticalPosition:"top"})}error(e){let n=e.error instanceof ErrorEvent?e.error.message:`Error Code: ${e.status}\nMessage: ${e.message}`;return console.log("backend service error:",n),this.showSnackBar(n),(0,N.of)({data:[],message:n,status:500})}wrapHttpCall(e){return e.pipe((0,P.X)(2),(0,U.K)(this.error))}load(e){const n=this.http.get([this.backendServerUrl,"load",e].join("/"),this.httpOptions);return this.wrapHttpCall(n)}dump(e,n){const i=this.http.post([this.backendServerUrl,"dump",e].join("/"),n,this.httpOptions);return this.wrapHttpCall(i)}loadHoldings(){const e=this.http.get("assets/holdings.json");return this.wrapHttpCall(e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(S.eN),t.LFG(k.ux))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var w=c(1133),F=c(4195),Z=c(7423),T=c(5245),x=c(7322),b=c(7531),M=c(4834),Y=c(9950),B=c(1791),Q=c(1948),A=c(4350),J=c(8894);function $(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"h3"),t._uU(2),t.ALo(3,"currency"),t.ALo(4,"currency"),t.qZA(),t.BQk()),2&o){const e=s.$implicit;t.xp6(2),t.HOy(" The ",e.account," account holds ",e.sharesOwned," shares, bought for ",t.lcZ(3,4,e.costAverage)," per share. Total cost was ",t.lcZ(4,6,e.costBasis),". ")}}let I=(()=>{class o{constructor(e,n){this.stocksService=e,this.crudService=n,this.callCount=0}ngOnInit(){this.stocksService.loadStockResource(this.stockStats.symbol,"news").subscribe(e=>{this.stockNews=Object.values(e.data).sort((n,i)=>i.providerPublishTime-n.providerPublishTime)}),this.crudService.load("holdings").subscribe(e=>{200===e.status&&(this.holdings=e.data[this.stockStats.symbol])})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w.T),t.Y36(_))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-stocks-details"]],inputs:{stockStats:"stockStats"},decls:14,vars:7,consts:[["mat-align-tabs","center"],["label","Chart"],[3,"symbol"],["label","Stats"],[3,"stockStats"],["label","financials"],["label","News"],[3,"news"],["label","Company"],[3,"symbol","profile"],["label","Holdings"],[4,"ngFor","ngForOf"]],template:function(e,n){1&e&&(t._UZ(0,"mat-divider"),t.TgZ(1,"mat-tab-group",0)(2,"mat-tab",1),t._UZ(3,"app-stock-chart-panel",2),t.qZA(),t.TgZ(4,"mat-tab",3),t._UZ(5,"app-stock-stats-panel",4),t.qZA(),t.TgZ(6,"mat-tab",5),t._UZ(7,"app-stock-financials-panel",2),t.qZA(),t.TgZ(8,"mat-tab",6),t._UZ(9,"app-stock-news-panel",7),t.qZA(),t.TgZ(10,"mat-tab",8),t._UZ(11,"app-stock-profile-panel",9),t.qZA(),t.TgZ(12,"mat-tab",10),t.YNc(13,$,5,8,"ng-container",11),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("symbol",n.stockStats.symbol),t.xp6(2),t.Q6J("stockStats",n.stockStats),t.xp6(2),t.Q6J("symbol",n.stockStats.symbol),t.xp6(2),t.Q6J("news",n.stockNews),t.xp6(2),t.Q6J("symbol",n.stockStats.symbol)("profile",n.stockStats.summaryProfile),t.xp6(2),t.Q6J("ngForOf",n.holdings))},directives:[M.d,h.SP,h.uX,Y.S,B.g,Q.M,A.g,J.l,p.sg],pipes:[p.H9],styles:["mat-tab-group[_ngcontent-%COMP%]{padding-bottom:20px}"]}),o})();const q=["singleQuoteWidget"];function E(o,s){if(1&o&&(t.TgZ(0,"th",25),t._uU(1),t.qZA()),2&o){const e=t.oxw().index,n=t.oxw();t.xp6(1),t.Oqu(n.headers[e])}}function j(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw(2).expandRow(i)}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.symbol," ")}}function G(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"button",7)(2,"mat-icon",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw(2).refreshStock(i)}),t._uU(3,"refresh"),t.qZA()(),t.TgZ(4,"button",7)(5,"mat-icon",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw(2).expandRow(i)}),t._uU(6),t.qZA()()()}if(2&o){const e=t.oxw(3);t.xp6(6),t.Oqu(e.expandedRow?"expand_less":"expand_more")}}const D=function(o){return{color:o}};function z(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"span",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw(2).expandRow(i)}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw().$implicit,n=t.oxw().index,i=t.oxw();t.Q6J("ngStyle",t.VKq(2,D,i.getColColor(e,n))),t.xp6(1),t.hij(" ",i.cells[n](e)," ")}}function X(o,s){if(1&o&&(t.TgZ(0,"td",26),t.YNc(1,j,2,1,"div",27),t.YNc(2,G,7,1,"div",28),t.YNc(3,z,2,4,"ng-template",null,29,t.W1O),t.qZA()),2&o){const e=t.MAs(4),n=t.oxw().index;t.xp6(1),t.Q6J("ngIf",0===n)("ngIfElse",e),t.xp6(1),t.Q6J("ngIf",14===n)}}function L(o,s){if(1&o&&(t.TgZ(0,"td",32),t._uU(1),t.qZA()),2&o){const e=t.oxw().index,n=t.oxw();t.Q6J("ngStyle",t.VKq(2,D,"-"===n.footerRow[e]()[1]?"tomato":"forestgreen")),t.xp6(1),t.hij(" ",n.footerRow[e]()," ")}}function W(o,s){if(1&o&&(t.ynx(0,22),t.YNc(1,E,2,1,"th",23),t.YNc(2,X,5,3,"td",16),t.YNc(3,L,2,4,"td",24),t.BQk()),2&o){const n=s.index;t.Q6J("matColumnDef",s.$implicit)("sticky",0===n)}}function V(o,s){if(1&o&&t._UZ(0,"app-stocks-details",35),2&o){const e=t.oxw().$implicit;t.Q6J("stockStats",e.stats)}}function K(o,s){if(1&o&&(t.TgZ(0,"td",26)(1,"div",33),t.YNc(2,V,1,1,"app-stocks-details",34),t.qZA()()),2&o){const e=s.$implicit,n=t.oxw();t.uIk("colspan",n.columnDefs.length),t.xp6(1),t.Q6J("@detailExpand",e===n.expandedRow?"expanded":"collapsed"),t.xp6(1),t.Q6J("ngIf",n.expandedRow&&n.expandedRow.symbol===e.symbol)}}function tt(o,s){1&o&&t._UZ(0,"tr",36)}function et(o,s){if(1&o&&t._UZ(0,"tr",37),2&o){const e=s.$implicit,n=t.oxw();t.ekj("example-expanded-row",n.expandedRow===e)}}function ot(o,s){1&o&&t._UZ(0,"tr",38)}function nt(o,s){1&o&&t._UZ(0,"tr",39)}function at(o,s){if(1&o&&(t.TgZ(0,"tr",40)(1,"td",41),t._uU(2),t.qZA()()),2&o){t.oxw();const e=t.MAs(15);t.xp6(2),t.hij(" Wow! No data matching the filter. ",e.value," ")}}const st=function(){return["expandedRow"]};let it=(()=>{class o{constructor(e,n,i,l){this.activatedRoute=e,this.snackBar=n,this.crudService=i,this.stocksService=l,this.holdings={},this.dataSource=new r.by,this.columnDefs=["symbol","sharesOwned","costAverage","costBasis","marketValue","gainLoss","glPercent","yield","yieldPercent","yieldOnCost","payoutRatio","exDivDate","sector","analysis","actions"],this.headers=["Symbol","Shares Owned","Cost Average","Cost Basis","Market Value","Gain","Gain %","Yield","Yield %","Yield on Cost","Payout Ratio","Ex-Div Date","Sector","Analysis",""],this.cells=[a=>a.symbol,a=>a.sharesOwned,a=>`$${a.costAverage}`,a=>`$${a.costBasis}`,a=>`$${a.marketValue}`,a=>`$${a.gainLoss}`,a=>`${a.glPercent}%`,a=>`$${a.yield}`,a=>`${a.yieldPercent}%`,a=>`${a.yieldOnCost}%`,a=>`${a.payoutRatio}%`,a=>`${a.exDivDate}`,a=>a.sector,a=>a.analysis.toUpperCase(),a=>""],this.footerRow=[()=>"",()=>"",()=>"",()=>`$${this.dataSource.data.map(a=>a.sharesOwned*a.costAverage).reduce((a,m)=>a+m,0).toFixed(2)}`,()=>`$${this.dataSource.data.map(a=>a.sharesOwned*a.marketPrice).reduce((a,m)=>a+m,0).toFixed(2)}`,()=>`$${this.dataSource.data.map(a=>(a.marketPrice-a.costAverage)*a.sharesOwned).reduce((a,m)=>a+m,0).toFixed(2)}`,()=>"",()=>`$${this.dataSource.data.map(a=>a.yield*a.sharesOwned).reduce((a,m)=>a+m,0).toFixed(2)}`,()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>""]}getColColor(e,n){switch(n){case 5:return"-"===this.cells[n](e)[1]?"tomato":"forestgreen";case 6:return"-"===this.cells[n](e)[0]?"tomato":"forestgreen";case 7:case 8:return"0%"!==this.cells[n](e)?"steelblue":"#191919";case 10:return e.payoutRatio>=50?"tomato":"#191919";case 13:return this.getAnalysisColor(e.analysis);default:return"#191919"}}getAnalysisColor(e){switch(e){case"strong buy":return"forestgreen";case"buy":return"limegreen";case"hold":return"steelblue";case"underperform":return"orange";case"sell":return"tomato";default:return"#191919"}}ngOnInit(){this.today=new Date,this.activatedRoute.data.subscribe(e=>{console.log("!!!data!!!"),console.log(e)}),this.crudService.load("holdings").subscribe(e=>{200===e.status?this.holdings=e.data:this.showSnackBar(e.message)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}showSnackBar(e,n="Dismiss"){return this.snackBar.open(e,n,{duration:3e3,horizontalPosition:"right",verticalPosition:"top"})}applyFilter(e){this.dataSource.filter=e.target.value}calculateStockData(e){return e.map(n=>{const i=n.holdings.map(u=>u.sharesOwned).reduce((u,v)=>u+v,0),l=n.holdings.map(u=>u.costAverage*u.sharesOwned).reduce((u,v)=>u+v,0).toFixed(2),a={symbol:n.symbol,sharesOwned:i,costAverage:+(l/i).toFixed(2),marketPrice:n.price.regularMarketPrice,costBasis:l,marketValue:+(n.price.regularMarketPrice*i).toFixed(2),payoutRatio:+(100*n.summaryDetail.payoutRatio).toFixed(2),exDivDate:new Date(1e3*n.summaryDetail.exDividendDate).toLocaleDateString("en-US")};"EQUITY"===n.quoteType.quoteType?(a.yield=n.summaryDetail.dividendRate||0,a.yieldPercent=+(100*n.summaryDetail.dividendYield).toFixed(2)||0,a.sector=n.summaryProfile.sector,a.analysis=n.financialData.recommendationKey.split("_").join(" ")):(a.yield=n.summaryDetail.yield?+(n.summaryDetail.yield*a.marketPrice).toFixed(2):0,a.yieldPercent=+(100*n.summaryDetail.yield).toFixed(2)||0,a.sector="N/A",a.analysis="None"),a.gainLoss=+((a.marketPrice-a.costAverage)*a.sharesOwned).toFixed(2),a.glPercent=+((a.marketPrice-a.costAverage)/a.costAverage*100).toFixed(2),a.glPercent=isFinite(a.glPercent)?a.glPercent:100,a.yieldOnCost=+(a.yield/a.costAverage*100).toFixed(2)||0;const m=(new Date).getFullYear();return a.exDivDate=a.exDivDate.endsWith(m)?a.exDivDate:"",a.stats=n,a})}expandRow(e){this.expandedRow=this.expandedRow===e?null:e}refreshAllStocks(){this.showSnackBar("Fetching all stock data..."),this.stocksService.stocksData("fetch").subscribe(e=>{this.showSnackBar(e.message)})}refreshStock(e){this.showSnackBar(`Fetching data for ${e.symbol}`),this.stocksService.fetchOneTickerData(e.symbol).subscribe(n=>{this.showSnackBar(n.message)})}saveHoldings(){this.showSnackBar("Saving stocks data..."),this.crudService.dump("holdings",this.holdings).subscribe(e=>{this.showSnackBar(e.message)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(C.gz),t.Y36(k.ux),t.Y36(_),t.Y36(w.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-stocks"]],viewQuery:function(e,n){if(1&e&&(t.Gf(r.BZ,5),t.Gf(H.NW,5),t.Gf(f.YE,5),t.Gf(q,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.table=i.first),t.iGM(i=t.CRH())&&(n.paginator=i.first),t.iGM(i=t.CRH())&&(n.sort=i.first),t.iGM(i=t.CRH())&&(n.singleQuoteWidget=i.first)}},decls:26,vars:14,consts:[[1,"container-header"],[1,"summary"],["icon","paid","subtitle","Market Value",3,"value"],["icon","paid","subtitle","Investment",3,"value"],["icon","paid","subtitle","Unrealized Gain/Lost",3,"value","color"],["icon","paid","subtitle","Dividend Income","color","steelblue",3,"value"],[1,"table-actions"],["mat-button","","color","primary"],[1,"material-icons-round",3,"click"],["appearance","standard"],["matInput","",3,"keyup"],["input",""],[1,"table-container"],["mat-table","","matSort","","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef","sticky",4,"ngFor","ngForOf"],["matColumnDef","expandedRow"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","table-header",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","stock-row",3,"example-expanded-row",4,"matRowDef","matRowDefColumns"],["mat-row","","class","expanded-stock-row",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","table-footer",4,"matFooterRowDef","matFooterRowDefSticky"],["class","mat-row",4,"matNoDataRow"],[3,"matColumnDef","sticky"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-footer-cell","",3,"ngStyle",4,"matFooterCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["class","table-col-0",3,"click",4,"ngIf","ngIfElse"],[4,"ngIf"],["elseBlock",""],[1,"table-col-0",3,"click"],[3,"ngStyle","click"],["mat-footer-cell","",3,"ngStyle"],[1,"expanded-stock-detail"],[3,"stockStats",4,"ngIf"],[3,"stockStats"],["mat-header-row","",1,"table-header"],["mat-row","",1,"stock-row"],["mat-row","",1,"expanded-stock-row"],["mat-footer-row","",1,"table-footer"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,n){1&e&&(t.ynx(0),t.TgZ(1,"div",0)(2,"header",1),t._UZ(3,"app-stat-card",2)(4,"app-stat-card",3)(5,"app-stat-card",4)(6,"app-stat-card",5),t.qZA(),t.TgZ(7,"div",6)(8,"button",7)(9,"mat-icon",8),t.NdJ("click",function(){return n.refreshAllStocks()}),t._uU(10,"refresh"),t.qZA()(),t.TgZ(11,"mat-form-field",9)(12,"mat-label"),t._uU(13,"Filter"),t.qZA(),t.TgZ(14,"input",10,11),t.NdJ("keyup",function(l){return n.applyFilter(l)}),t.qZA()()()(),t.TgZ(16,"div",12)(17,"table",13),t.YNc(18,W,4,2,"ng-container",14),t.ynx(19,15),t.YNc(20,K,3,3,"td",16),t.BQk(),t.YNc(21,tt,1,0,"tr",17),t.YNc(22,et,1,2,"tr",18),t.YNc(23,ot,1,0,"tr",19),t.YNc(24,nt,1,0,"tr",20),t.YNc(25,at,3,1,"tr",21),t.qZA()(),t.BQk()),2&e&&(t.xp6(3),t.Q6J("value",n.footerRow[4]()),t.xp6(1),t.Q6J("value",n.footerRow[3]()),t.xp6(1),t.Q6J("value",n.footerRow[5]())("color","-"===n.footerRow[6]()[1]?"tomato":"forestgreen"),t.xp6(1),t.Q6J("value",n.footerRow[7]()),t.xp6(11),t.Q6J("dataSource",n.dataSource),t.xp6(1),t.Q6J("ngForOf",n.columnDefs),t.xp6(3),t.Q6J("matHeaderRowDef",n.columnDefs)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.columnDefs),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(13,st)),t.xp6(1),t.Q6J("matFooterRowDef",n.columnDefs)("matFooterRowDefSticky",!0))},directives:[F.i,Z.lW,T.Hw,x.KE,x.hX,b.Nt,r.BZ,f.YE,p.sg,r.w1,r.fO,r.ge,f.nU,r.Dz,r.ev,p.O5,p.PC,r.mD,r.yh,I,r.as,r.XQ,r.nj,r.Gk,r.Ke,r.Q2,r.Ee],styles:[".container-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}.summary[_ngcontent-%COMP%]{display:flex;align-items:center}.table-actions[_ngcontent-%COMP%]{display:flex;justify-content:right;align-items:center;margin-right:2%}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;margin-top:10px}.table-col-0[_ngcontent-%COMP%]{display:flex;align-items:center;align-content:center;margin:0;padding:0}.table-col-3[_ngcontent-%COMP%], .table-col-8[_ngcontent-%COMP%]{width:max-content;margin-right:5px}.expanded-stock-detail[_ngcontent-%COMP%]{overflow:hidden;align-items:center}.table-header[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}th.mat-sort-header-sorted[_ngcontent-%COMP%]{color:#191919}.mat-cell[_ngcontent-%COMP%]{padding-right:20px}.mat-row[_ngcontent-%COMP%]:not(.expanded-stock-row):hover   .mat-cell[_ngcontent-%COMP%]{font-weight:700}tr.expanded-stock-row[_ngcontent-%COMP%]{height:0}.single-quote-widget[_ngcontent-%COMP%]{height:90px;margin-right:10px}"],data:{animation:[(0,g.X$)("detailExpand",[(0,g.SB)("collapsed",(0,g.oB)({height:"0px",minHeight:"0"})),(0,g.SB)("expanded",(0,g.oB)({height:"*"})),(0,g.eR)("expanded <=> collapsed",(0,g.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),o})(),ct=(()=>{class o{constructor(e,n){this.crudService=e,this.stocksService=n,this.news=[]}ngOnInit(){this.stocksService.loadPortfolioNews().subscribe(e=>{200===e.status&&(this.news=e.data)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_),t.Y36(w.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-news"]],decls:1,vars:1,consts:[[3,"news"]],template:function(e,n){1&e&&t._UZ(0,"app-stock-news-panel",0),2&e&&t.Q6J("news",n.news)},directives:[A.g],styles:[".add-padding[_ngcontent-%COMP%]{padding:20px}.news-container[_ngcontent-%COMP%]{padding-bottom:5px}.news-item[_ngcontent-%COMP%]{display:flex;margin:0 0 3px;align-items:center}.news-item[_ngcontent-%COMP%] > a[_ngcontent-%COMP%], span[_ngcontent-%COMP%], mat-icon[_ngcontent-%COMP%]{margin-right:10px}a[_ngcontent-%COMP%]{color:#4682b4}"]}),o})();const rt_InvestmentAccounts=["Schwab","Webull","Roth","HSA","Coinbase"];var lt=c(4107),dt=c(508),mt=c(3737);function pt(o,s){if(1&o&&(t.TgZ(0,"mat-option",32),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.s9C("value",e),t.xp6(1),t.Oqu(e)}}function ut(o,s){1&o&&(t.TgZ(0,"th",33),t._uU(1,"Ticker"),t.qZA())}function gt(o,s){if(1&o&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.ticker)}}function ft(o,s){1&o&&t._UZ(0,"td",35)}function ht(o,s){1&o&&(t.TgZ(0,"th",33),t._uU(1,"Shares"),t.qZA())}function _t(o,s){if(1&o&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.sharesOwned)}}function xt(o,s){1&o&&t._UZ(0,"td",35)}function Ct(o,s){1&o&&(t.TgZ(0,"th",33),t._uU(1,"Cost Average"),t.qZA())}function wt(o,s){if(1&o&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.costAverage))}}function vt(o,s){1&o&&t._UZ(0,"td",35)}function yt(o,s){1&o&&(t.TgZ(0,"th",33),t._uU(1,"Cost Basis"),t.qZA())}function kt(o,s){if(1&o&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.costBasis))}}function St(o,s){1&o&&t._UZ(0,"td",35)}function Zt(o,s){1&o&&(t.TgZ(0,"th",33),t._uU(1,"Account"),t.qZA())}function Tt(o,s){if(1&o&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.account)}}function bt(o,s){1&o&&t._UZ(0,"td",35)}function At(o,s){1&o&&t._UZ(0,"th",36)}function Dt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"td",34)(1,"button",14),t.NdJ("click",function(){const i=t.CHM(e),l=i.$implicit,a=i.index;return t.oxw().editHolding(l,a)}),t.TgZ(2,"mat-icon",13),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",37),t.NdJ("click",function(){const l=t.CHM(e).index;return t.oxw().deleteHolding(l)}),t.TgZ(5,"mat-icon",13),t._uU(6,"delete"),t.qZA()()()}}function Ot(o,s){1&o&&t._UZ(0,"tr",38)}function Rt(o,s){1&o&&t._UZ(0,"tr",39)}function Ht(o,s){if(1&o&&(t.TgZ(0,"tr",40)(1,"td",41),t._uU(2),t.qZA()()),2&o){t.oxw();const e=t.MAs(30);t.xp6(2),t.hij(' Wow! No data matching the filter "',e.value,'". ')}}let Nt=(()=>{class o{constructor(e,n){this.crudService=e,this.fb=n,this.dataSource=new r.by,this.columnDefs=["ticker","sharesOwned","costAverage","costBasis","account","actions"],this.holdingForm=new d.cw({}),this.investmentAccounts=rt_InvestmentAccounts,this.selectedRow={},this.selectedRowIndex=-1,this.holdingForm=this.fb.group({ticker:["",d.kI.required],sharesOwned:["",d.kI.required],costAverage:["",d.kI.required],account:["",d.kI.required]})}ngOnInit(){this.crudService.load("holdings").subscribe(e=>{if(200===e.status){const n=[];Object.values(e.data).forEach(i=>{for(let l of i)l.costBasis=l.costAverage*l.sharesOwned,n.push(l)}),this.dataSource.data=n}})}ngAfterViewInit(){this.dataSource.sort=this.sort}applyFilter(e){this.dataSource.filter=e.target.value}addHolding(){const e=this.dataSource.data,n=this.holdingForm.value;n.costBasis=n.sharesOwned*n.costAverage,this.holdingForm.valid&&-1===this.selectedRowIndex?(e.push(n),this.dataSource.data=e,console.log("added!")):this.holdingForm.valid&&-1!==this.selectedRowIndex?(e[this.selectedRowIndex]=n,this.dataSource.data=e,console.log("updated!")):console.log("Invalid holding"),this.holdingForm.reset(),this.selectedRow=null,this.selectedRowIndex=-1,console.log(this.selectedRow,this.selectedRowIndex)}editHolding(e,n){this.selectedRow=Object.assign({},e),this.selectedRowIndex=n,delete this.selectedRow.costBasis,this.holdingForm.setValue(this.selectedRow)}deleteHolding(e){const n=this.dataSource.data;n.splice(e,1),this.dataSource.data=n}saveHoldings(){const n={};this.dataSource.data.map(i=>{n[i.ticker]=n[i.ticker]?[...n[i.ticker],i]:[i]}),console.log(n),this.crudService.dump("holdings",n).subscribe(i=>{console.log(i.message)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_),t.Y36(d.qu))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-holdings"]],viewQuery:function(e,n){if(1&e&&(t.Gf(r.BZ,5),t.Gf(f.YE,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.table=i.first),t.iGM(i=t.CRH())&&(n.sort=i.first)}},decls:58,vars:6,consts:[[1,"holdings-actions"],[1,"form-group","center",3,"formGroup","ngSubmit"],[1,"form-field"],["for","ticker"],["matInput","","formControlName","ticker","type","text","id","ticker","oninput","this.value = this.value.toUpperCase()",1,"form-control"],["for","sharesOwned"],["matInput","","formControlName","sharesOwned","type","number","id","sharesOwned",1,"form-control"],["for","costAverage"],["matInput","","formControlName","costAverage","type","number","id","costAverage",1,"form-control"],["for","account"],["formControlName","account","id","account",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","type","submit","color","primary"],[1,"material-icons-round"],["mat-button","","color","primary",3,"click"],["appearance","standard"],["matInput","",3,"keyup"],["input",""],["mat-table","","matSort","",1,"mat-elevation-z8","holdings-table",3,"dataSource"],["matColumnDef","ticker"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","sharesOwned"],["matColumnDef","costAverage"],["matColumnDef","costBasis"],["matColumnDef","account"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","","class","table-header",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","cdkDrag","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"value"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["mat-header-cell",""],["mat-button","","color","warn",3,"click"],["mat-header-row","",1,"table-header"],["mat-row","","cdkDrag",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("ngSubmit",function(){return n.addHolding()}),t.TgZ(2,"mat-form-field",2)(3,"mat-label",3),t._uU(4,"Ticker"),t.qZA(),t._UZ(5,"input",4),t.qZA(),t.TgZ(6,"mat-form-field",2)(7,"mat-label",5),t._uU(8,"Shares Owned"),t.qZA(),t._UZ(9,"input",6),t.qZA(),t.TgZ(10,"mat-form-field",2)(11,"mat-label",7),t._uU(12,"Cost Average"),t.qZA(),t._UZ(13,"input",8),t.qZA(),t.TgZ(14,"mat-form-field",2)(15,"mat-label",9),t._uU(16,"Account"),t.qZA(),t.TgZ(17,"mat-select",10),t.YNc(18,pt,2,2,"mat-option",11),t.qZA()(),t.TgZ(19,"button",12)(20,"mat-icon",13),t._uU(21,"post_add"),t.qZA()()(),t.TgZ(22,"div")(23,"button",14),t.NdJ("click",function(){return n.saveHoldings()}),t.TgZ(24,"mat-icon",13),t._uU(25,"save"),t.qZA()(),t.TgZ(26,"mat-form-field",15)(27,"mat-label"),t._uU(28,"Filter"),t.qZA(),t.TgZ(29,"input",16,17),t.NdJ("keyup",function(l){return n.applyFilter(l)}),t.qZA()()()(),t.TgZ(31,"table",18),t.ynx(32,19),t.YNc(33,ut,2,0,"th",20),t.YNc(34,gt,2,1,"td",21),t.YNc(35,ft,1,0,"td",22),t.BQk(),t.ynx(36,23),t.YNc(37,ht,2,0,"th",20),t.YNc(38,_t,2,1,"td",21),t.YNc(39,xt,1,0,"td",22),t.BQk(),t.ynx(40,24),t.YNc(41,Ct,2,0,"th",20),t.YNc(42,wt,3,3,"td",21),t.YNc(43,vt,1,0,"td",22),t.BQk(),t.ynx(44,25),t.YNc(45,yt,2,0,"th",20),t.YNc(46,kt,3,3,"td",21),t.YNc(47,St,1,0,"td",22),t.BQk(),t.ynx(48,26),t.YNc(49,Zt,2,0,"th",20),t.YNc(50,Tt,2,1,"td",21),t.YNc(51,bt,1,0,"td",22),t.BQk(),t.ynx(52,27),t.YNc(53,At,1,0,"th",28),t.YNc(54,Dt,7,0,"td",21),t.BQk(),t.YNc(55,Ot,1,0,"tr",29),t.YNc(56,Rt,1,0,"tr",30),t.YNc(57,Ht,3,1,"tr",31),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",n.holdingForm),t.xp6(17),t.Q6J("ngForOf",n.investmentAccounts),t.xp6(13),t.Q6J("dataSource",n.dataSource),t.xp6(24),t.Q6J("matHeaderRowDef",n.columnDefs)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.columnDefs))},directives:[d._Y,d.JL,d.sg,x.KE,x.hX,b.Nt,d.Fj,d.JJ,d.u,d.wV,lt.gD,p.sg,dt.ey,Z.lW,T.Hw,r.BZ,f.YE,r.w1,r.fO,r.ge,f.nU,r.Dz,r.ev,r.mD,r.yh,r.as,r.XQ,r.nj,r.Gk,mt.Zt,r.Ee],pipes:[p.H9],styles:[".holdings-actions[_ngcontent-%COMP%]{display:flex;align-items:center;align-content:center;justify-content:space-between}.holdings-actions[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:2%}.holdings-table[_ngcontent-%COMP%]{width:100%}.form-group[_ngcontent-%COMP%]{margin-left:2%;width:max-content}"]}),o})();const Pt=[{path:"",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-portfolio"]],decls:7,vars:0,consts:[["mat-align-tabs","left"],["label","Portfolio"],["label","News"],["label","Holdings"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-tab-group",0)(1,"mat-tab",1),t._UZ(2,"app-stocks"),t.qZA(),t.TgZ(3,"mat-tab",2),t._UZ(4,"app-news"),t.qZA(),t.TgZ(5,"mat-tab",3),t._UZ(6,"app-holdings"),t.qZA()())},directives:[h.SP,h.uX,it,ct,Nt],styles:[""]}),o})()}];let Ut=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[C.Bz.forChild(Pt)],C.Bz]}),o})(),Ft=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.ez,d.UX,Ut,O.i,R.q]]}),o})()}}]);