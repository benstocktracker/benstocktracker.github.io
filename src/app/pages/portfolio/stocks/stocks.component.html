<ng-container>
  <div class="container-header">
    <header class="summary">
      <app-stat-card icon="paid" [value]="footerRow[4]()" subtitle="Market Value"></app-stat-card>
      <app-stat-card icon="paid" [value]="footerRow[3]()" subtitle="Investment"></app-stat-card>
      <app-stat-card icon="paid" [value]="footerRow[5]()" subtitle="Unrealized Gain/Lost" [color]="footerRow[6]()[1] === '-' ? 'tomato': 'forestgreen'"></app-stat-card>
      <app-stat-card icon="paid" [value]="footerRow[7]()" subtitle="Dividend Income" color="steelblue"></app-stat-card>
    </header>
    <div class="table-actions">
      <button mat-button color="primary">
        <mat-icon class="material-icons-round" (click)="refreshAllStocks()">refresh</mat-icon>
      </button>
      <mat-form-field appearance="standard">
        <mat-label>Filter</mat-label>
        <input matInput (keyup)="applyFilter($event)" #input>
      </mat-form-field>
    </div>
  </div>
  
  <div class="table-container">
    <!-- matSortActive="yieldOnCost" matSortDirection="desc" -->
    <table mat-table matSort multiTemplateDataRows [dataSource]="dataSource" class="mat-elevation-z8">
      <ng-container *ngFor="let column of columnDefs; index as cidx" [matColumnDef]="column" [sticky]="cidx === 0">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ headers[cidx] }}</th>
        <td mat-cell *matCellDef="let stock">
          <div *ngIf="cidx === 0; else elseBlock" class="table-col-0" (click)="expandRow(stock)">
            <!-- <app-single-quote-widget symbol="{{stock.symbol}}" class="single-quote-widget"></app-single-quote-widget> -->
            {{ stock.symbol }}
          </div>
          <div *ngIf="cidx === 14">
            <button mat-button color="primary">
              <mat-icon class="material-icons-round" (click)="refreshStock(stock)">refresh</mat-icon>
            </button>
            <button mat-button color="primary">
              <mat-icon class="material-icons-round" (click)="expandRow(stock)">{{ expandedRow ? 'expand_less' : 'expand_more' }}</mat-icon>
            </button>
          </div>
          <ng-template #elseBlock>
            <span [ngStyle]="{'color': getColColor(stock, cidx)}" (click)="expandRow(stock)">
              {{ cells[cidx](stock) }}
            </span>
          </ng-template>
        </td>
        <td mat-footer-cell *matFooterCellDef [ngStyle]="{'color': (footerRow[cidx]()[1] === '-') ? 'tomato' : 'forestgreen'}">
          {{ footerRow[cidx]() }}
        </td>
      </ng-container>
  
      <ng-container matColumnDef="expandedRow">
        <td mat-cell *matCellDef="let stock" [attr.colspan]="columnDefs.length">
          <div class="expanded-stock-detail" [@detailExpand]="stock === expandedRow ? 'expanded' : 'collapsed'">
            <app-stocks-details *ngIf="expandedRow && expandedRow.symbol === stock.symbol" [stockStats]="stock.stats"></app-stocks-details>
          </div>
        </td>
      </ng-container>
  
      <tr mat-header-row *matHeaderRowDef="columnDefs; sticky: true" class="table-header"></tr>
      <tr mat-row *matRowDef="let row; columns: columnDefs"
          class="stock-row" 
          [class.example-expanded-row]="expandedRow === row"
      >
      </tr>
      <tr mat-row *matRowDef="let row; columns: ['expandedRow']" class="expanded-stock-row"></tr>
      <tr mat-footer-row *matFooterRowDef="columnDefs; sticky: true" class="table-footer"></tr>
  
      <!-- Row shown when there is no matching data. -->
      <tr *matNoDataRow class="mat-row">
        <td class="mat-cell" colspan="4">
          Wow! No data matching the filter. {{ input.value }}
        </td>
      </tr>
    </table>
  
    <!-- <mat-paginator [length]="dataSource.data.length" 
                  [pageSizeOptions]="[5, 10, 20, 50]" 
                  [pageSize]="50"
                  showFirstLastButtons>
    </mat-paginator> -->
  </div>
</ng-container>
